syntax = "proto3";

package anet;

message AuthRequest {
    string key = 1;
}

message AuthResponse {
    string ip = 1;
    string netmask = 2;
    string gateway = 3;
    int32 mtu = 4;
    bytes crypto_key = 5;  // 32-байтовый ключ для ChaCha20Poly1305
    uint32 udp_port = 6;   // Порт для UDP соединения
    string session_id = 7;
}

message UdpHandshake {
    string client_id = 1;   // 16-байтовый идентификатор клиента
    uint64 timestamp = 2;  // Метка времени для защиты от replay-атак
}

message Message {
    oneof content {
        AuthRequest auth_request = 1;
        AuthResponse auth_response = 2;
        UdpHandshake udp_handshake = 3;
    }
}
