# =========================================================================
# ANET Client: Основные настройки соединения
# =========================================================================
[main]
# IP-адрес или доменное имя сервера ANet и его порт для подключения.
# Клиент будет использовать этот адрес для всего процесса: от аутентификации
# до передачи данных по QUIC.
# Пример: "vpn.example.com:8443" или "192.0.2.1:8443"
address = "127.0.0.1:8445"

# Имя, которое будет присвоено виртуальному сетевому TUN-интерфейсу,
# создаваемому на стороне клиента. В Windows это имя будет видно в списке
# сетевых адаптеров, в Linux - в выводе команды `ip addr`.
# Пример: "anet0" или "my-vpn-link"
tun_name = "anet-client"

# Включает ручное управление роутингом на клиенте
# Для GUI не имеет смысла, там этот параметр не работает.
# By request in https://github.com/ZeroTworu/anet/issues/13
manual_routing = false

# =========================================================================
# Настройки Маршрутизации (Split Tunneling)
# =========================================================================
# ANet поддерживает два режима раздельного туннелирования.
# Выбор режима зависит от того, заполнен ли список `route_for`.
#
# Поддерживаемые форматы для списков:
# 1. Домены: "youtube.com", "my.bank.ru" (резолвятся в IP при запуске).
# 2. Одиночные IP: "1.1.1.1", "203.0.113.10".
# 3. Подсети (CIDR): "192.168.0.0/16", "10.0.0.0/8".
# =========================================================================

# -------------------------------------------------------------------------
# Режим 1: "Белый список" (INCLUDE Mode)
# -------------------------------------------------------------------------
# Если этот список НЕ ПУСТ, включается режим "Только избранное".
#
# Как это работает:
# Весь трафик по умолчанию идет через вашего провайдера (напрямую, без VPN).
# В VPN-туннель заворачивается ТОЛЬКО трафик до ресурсов, указанных в этом списке.
# Параметр `exclude_route_for` в этом режиме ИГНОРИРУЕТСЯ.
#
# По умолчанию: [] (Список пуст -> Режим отключен)
route_for = []

# -------------------------------------------------------------------------
# Режим 2: "Черный список" (EXCLUDE Mode) (Лучше использовать его)
# -------------------------------------------------------------------------
# Работает ТОЛЬКО если `route_for` пуст (настройка выше = []).
#
# Как это работает:
# Включается глобальный VPN: ВЕСЬ трафик перенаправляется в зашифрованный туннель.
# Исключение составляют только ресурсы из этого списка — они пойдут напрямую
# через ваш физический шлюз (мимо VPN).
#
# Сценарии использования:
# 1. Доступ к домашней технике: Чтобы при включенном VPN вы не теряли доступ
#    к принтеру, NAS или умному дому. (Добавьте "192.168.0.0/16").
# 2. Конфликты с СБ: Корпоративные ресурсы (Jira/SAP), которые блокируют доступ
#    с иностранных IP.
# 3. Банковские приложения: Если банк блокирует доступ при использовании VPN.
#
# Пример: exclude_route_for = ["192.168.0.0/16", "online.sberbank.ru"]
#
# По умолчанию: [] (Весь трафик идет через VPN)
exclude_route_for = ["192.168.1.0/32"]
# -------------------------------------------------------------------------
# Настройки DNS резолвера (для Split Tunneling)
# -------------------------------------------------------------------------
# Список DNS-серверов, которые клиент использует при запуске для преобразования
# доменов из списка `route_for` в реальные IP-адреса.
#
# ВАЖНО:
# Поскольку маршрутизация работает на уровне IP-пакетов, клиенту необходимо
# знать, какие IP соответствуют доменам (например, youtube.com).
# Эти запросы выполняются локально при старте клиента.
#
# Рекомендуется использовать надежные публичные DNS (Cloudflare, Google),
# чтобы получить актуальные IP-адреса.
#
# По умолчанию: ["1.1.1.1", "8.8.8.8"]
dns_server_list = ["1.1.1.1", "8.8.8.8"]

[transport]
mode = "ssh" # "quic"
ssh_user = "hanyuu"


# =========================================================================
# ANET Client: Криптографические ключи
# =========================================================================
[keys]
# Приватный ключ клиента в формате Base64. Этот ключ используется для
# цифровой подписи на этапе аутентификации, подтверждая вашу личность
# перед сервером. Ключ генерируется утилитой `anet-keygen client`.
# ВАЖНО: Храните этот ключ в секрете, он является вашим удостоверением.
private_key = ""

# Публичный ключ сервера в формате Base64. Этот параметр позволяет клиенту
# верифицировать подпись сервера во время рукопожатия, обеспечивая защиту
# от атак "человек посередине" (Man-in-the-Middle).
server_pub_key = ""

# =========================================================================
# Настройки вывода статистики соединения
# =========================================================================
[stats]
# Включить (`true`) или выключить (`false`) периодический вывод в лог
# детальной статистики о состоянии QUIC-соединения. Полезно для
# отладки и мониторинга производительности.
# По умолчанию: false
enabled = true

# Интервал в минутах, с которым будет выводиться статистика в лог.
# Установите значение > 0.
# По умолчанию: 1
interval_minutes = 1

# =========================================================================
# Настройки маскировки трафика (Stealth)
# =========================================================================
# Эти параметры помогают скрыть факт использования VPN от систем DPI,
# изменяя размер пакетов и время их отправки.
[stealth]

# -------------------------------------------------------------------------
# Выравнивание размера пакетов (Padding)
# -------------------------------------------------------------------------
# Определяет "шаг" в байтах, до которого будет дополняться размер каждого пакета.
#
# Зачем это нужно:
# Без паддинга DPI видит реальный размер данных:
#   - 50-100 байт -> скорее всего, ввод команд в консоли (SSH) или ACK.
#   - 148 байт -> сигнатура WireGuard handshake.
#   - 1000+ байт -> передача файлов/видео.
# С паддингом все пакеты выглядят как унифицированные "кирпичи" (например, 64, 128, 192...).
# Это полностью скрывает тип активности пользователя.
#
# Значения:
#   0   - Отключено (режим "Хаос"). Пакеты имеют естественный размер.
#         Полезно против нейросетей, ищущих искусственные паттерны.
#   64  - (Рекомендуется) Баланс между скрытностью и расходом трафика.
#   128 - Высокая скрытность, но чуть больше накладных расходов (overhead).
#
# По умолчанию: 64
padding_step = 64

# -------------------------------------------------------------------------
# Имитация задержек сети (Jitter)
# -------------------------------------------------------------------------
# Добавляет случайную задержку перед отправкой каждого пакета.
# Значения указываются в наносекундах (ns).
# 1 миллисекунда (ms) = 1 000 000 наносекунд (ns).
#
# Зачем это нужно:
# DPI анализирует временные интервалы (Timing Analysis). Если пакет
# приходит на сервер и мгновенно улетает дальше, DPI понимает, что это прокси.
# Джиттер "размазывает" время доставки и меняет порядок пакетов (Reordering),
# делая поток похожим на работу обычной перегруженной сети.
#
# Рекомендации:
# 1. "Минимальный" (почти не влияет на пинг, сбивает точные тайминги):
#    min = 100000   (0.1 ms)
#    max = 500000   (0.5 ms)
#
# 2. "Сбалансированный" (хороший стелс, пинг +3мс):
#    min = 1000000  (1 ms)
#    max = 5000000  (5 ms)
#
# 3. "Параноидальный" (максимальная маскировка, пинг +15мс, возможны лаги в играх):
#    min = 5000000  (5 ms)
#    max = 20000000 (20 ms)
#
# Установите min и max в 0, чтобы отключить.

# Минимальная задержка (в наносекундах)
# По умолчанию: 1000000 (1 ms)
min_jitter_ns = 1000000

# Максимальная задержка (в наносекундах)
# По умолчанию: 5000000 (5 ms)
max_jitter_ns = 5000000


# =========================================================================
# Настройки транспорта QUIC (Quinn Transport Configuration)
# Эта секция управляет поведением протокола QUIC на транспортном уровне.
# Корректная настройка этих параметров критически важна для достижения
# оптимальной производительности и стабильности VPN-соединения, особенно
# на каналах с высокой задержкой или потерями пакетов.
# =========================================================================
[quic_transport]
# -------------------------------------------------------------------------
# Алгоритм контроля перегрузки (Congestion Control Algorithm)
# -------------------------------------------------------------------------
# Определяет, как клиент будет адаптировать скорость передачи данных в ответ
# на изменение состояния сети (задержки, потери пакетов).
# "bbr": Рекомендуемый алгоритм от Google. Эффективно определяет реальную
#     пропускную способность канала и RTT, что позволяет поддерживать
#     высокую скорость даже при наличии потерь пакетов. Идеален для
#     нестабильных и "длинных" каналов (например, мобильные сети, Wi-Fi).
# "cubic": Традиционный алгоритм, используемый во многих реализациях TCP.
#     Более чувствителен к потерям пакетов и может значительно снижать
#     скорость при нестабильном соединении.
algorithm = "bbr"

# -------------------------------------------------------------------------
# Параметры канала (канал связи клиента)
# -------------------------------------------------------------------------
# Начальная оценка времени кругового пути (Round-Trip Time) в миллисекундах.
# Это значение используется протоколом QUIC для инициализации таймеров
# и алгоритма контроля перегрузки. Укажите значение, близкое к вашему
# среднему пингу до VPN-сервера, для более быстрого выхода на стабильную
# скорость.
expected_rtt_ms = 80

# Оценка пропускной способности вашего канала для входящего трафика
# (Download, C <- S) в мегабитах в секунду.
# Используется для автоматического расчета размеров буферов приема
# (`receive_window`), если они не заданы явно.
bandwidth_down_mbps = 50

# Оценка пропускной способности вашего канала для исходящего трафика
# (Upload, C -> S) в мегабитах в секунду.
# Используется для автоматического расчета размера буфера отправки
# (`send_window`) и для начальной настройки BBR, что позволяет быстрее
# утилизировать исходящий канал.
bandwidth_up_mbps = 30

# -------------------------------------------------------------------------
# Размеры буферов (Flow Control Windows)
# Рекомендуется оставить эти параметры незаполненными для автоматического расчета.
# -------------------------------------------------------------------------
# Размер окна приема для отдельного QUIC-потока, в байтах. Ограничивает
# объем данных, который может быть принят в рамках одного потока без
# подтверждения. Если параметр не указан, рассчитывается автоматически.
# stream_receive_window =

# Общий размер окна приема для всего соединения, в байтах. Ограничивает
# общий объем данных, который клиент может буферизовать от сервера
# для всех потоков. Если параметр не указан, рассчитывается автоматически
# на основе `bandwidth_down_mbps`.
# receive_window =

# Общий размер окна отправки, в байтах. Определяет, какой объем данных
# клиент может отправить серверу без ожидания подтверждений. Напрямую
# влияет на скорость исходящего трафика (upload). Если параметр не указан,
# рассчитывается автоматически на основе `bandwidth_up_mbps`.
# send_window =

# -------------------------------------------------------------------------
# Дополнительные оптимизации
# -------------------------------------------------------------------------
# Включение Generic Segmentation Offload (GSO). Эта опция позволяет
# переложить задачу сегментации больших пакетов на сетевую карту,
# снижая нагрузку на CPU. Рекомендуется оставить включенной (`true`)
# для повышения производительности.
enable_gso = true

# Таймаут неактивности соединения в секундах. Если в течение этого
# времени между клиентом и сервером не будет обмена данными, соединение
# будет считаться разорванным. Установка большого значения (например,
# несколько часов) повышает стабильность на длительных сессиях.
idle_timeout_seconds = 21600

# Максимальный размер пакета для механизма Path MTU Discovery.
# Это "потолок", выше которого QUIC не будет пытаться поднять MTU.
# В 99% случаев стандартное значение 1500 является оптимальным.
# Изменяйте, только если вы точно знаете, что в вашей сети поддерживается больший MTU.
max_mtu = 1500
